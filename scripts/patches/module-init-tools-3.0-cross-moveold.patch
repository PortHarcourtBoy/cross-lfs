--- module-init-tools-3.0-ORIG/Makefile.in	2004-02-24 11:49:35.000000000 +1100
+++ module-init-tools-3.0/Makefile.in	2004-04-12 15:39:35.000000000 +1000
@@ -760,17 +760,10 @@
 
 release: check clean tarball testsuite
 
-moveold: check-for-sbin check-for-old move-old-targets
-
-check-for-sbin:
-	if [ "`echo $(DESTDIR)$(sbindir) | tr -s / /`" = /sbin ]; then :;    \
-	else								     \
-		echo moveold usually only makes sense when installing into /sbin; \
-		exit 1;							     \
-	fi
+moveold: check-for-old move-old-targets
 
 check-for-old:
-	if [ -f /sbin/lsmod.old ]; then					\
+	if [ -f $(DESTDIR)/sbin/lsmod.old ]; then					\
 		echo Someone already moved old versions. >&2; exit 1;	\
 	fi
 
@@ -779,26 +772,29 @@
 # Also, make symlink from /bin to /sbin for lsmod (FHS compliant).
 move-old-targets:
 	for f in lsmod modprobe rmmod depmod insmod modinfo; do		    \
-	    if [ -L /sbin/$$f ]; then					    \
-		ln -sf `ls -l /sbin/$$f | sed 's/.* -> //'`.old /sbin/$$f;  \
+	    if [ -L $(DESTDIR)/sbin/$$f ]; then				    \
+		ln -sf `ls -l $(DESTDIR)/sbin/$$f | sed 's/.* -> //'`.old   \
+			$(DESTDIR)/sbin/$$f;				    \
 	    fi;								    \
-	    mv /sbin/$$f /sbin/$$f.old;					    \
-	    if [ -f /usr/share/man/man8/$$f.8.gz ]; then		    \
-		mv /usr/share/man/man8/$$f.8.gz				    \
-			/usr/share/man/man8/$$f.old.8.gz;		    \
-	    elif [ -f /usr/share/man/man8/$$f.8.bz2 ]; then		    \
-	        mv /usr/share/man/man8/$$f.8.bz2			    \
-			/usr/share/man/man8/$$f.old.8.bz2;		    \
+	    mv $(DESTDIR)/sbin/$$f $(DESTDIR)/sbin/$$f.old;		    \
+	    if [ -f $(DESTDIR)/usr/share/man/man8/$$f.8.gz ]; then	    \
+		mv $(DESTDIR)/usr/share/man/man8/$$f.8.gz		    \
+			$(DESTDIR)/usr/share/man/man8/$$f.old.8.gz;	    \
+	    elif [ -f $(DESTDIR)/usr/share/man/man8/$$f.8.bz2 ]; then	    \
+	        mv $(DESTDIR)/usr/share/man/man8/$$f.8.bz2		    \
+			$(DESTDIR)/usr/share/man/man8/$$f.old.8.bz2;	    \
 	    else							    \
-	        mv /usr/share/man/man8/$$f.8 /usr/share/man/man8/$$f.old.8; \
+	        mv $(DESTDIR)/usr/share/man/man8/$$f.8			    \
+			$(DESTDIR)/usr/share/man/man8/$$f.old.8;	    \
 	    fi;								    \
 	done
 	for f in kallsyms ksyms; do					    \
-	    if [ -L /sbin/$$f ]; then					    \
-		ln -sf `ls -l /sbin/$$f | sed 's/.* -> //'`.old /sbin/$$f;  \
+	    if [ -L $(DESTDIR)/sbin/$$f ]; then				    \
+		ln -sf `ls -l $(DESTDIR)/sbin/$$f | sed 's/.* -> //'`.old   \
+			$(DESTDIR)/sbin/$$f;				    \
 	    fi;								    \
 	done
-	ln -s /sbin/lsmod.old /bin/lsmod.old
+	ln -s /sbin/lsmod.old $(DESTDIR)/bin/lsmod.old
 
 # For installs in /usr/local/sbin
 links:
