Submitted By: Ryan Oliver <ryan.oliver@pha.com.au>
Date: 2004-10-25
Initial Package Version: 2.1.20 (may apply to earlier)
Origin: Ryan Oliver
Description: This patch ensures that the plugin directory gets located
  under the same directory specified with "--with-libdir=" .
diff -uNr cyrus-sasl-2.1.20-orig/Makefile.in cyrus-sasl-2.1.20/Makefile.in
--- cyrus-sasl-2.1.20-orig/Makefile.in	2004-10-25 06:21:09.000000000 +1000
+++ cyrus-sasl-2.1.20/Makefile.in	2004-10-25 21:37:53.780833136 +1000
@@ -656,14 +656,14 @@
 	@find $(distdir) -exec chmod o+w {} ';'
 	@find $(distdir) -name CVS -print | xargs -t rm -rf
 install-exec-local: $(INSTALLOSX)
-	@if test "$(plugindir)" != "$(prefix)/lib/sasl2"; then \
+	@if test "$(plugindir)" != "$(libdir)/sasl2"; then \
 	  echo "********************************************************"; \
 	  echo "* WARNING:"; \
-	  echo "* Plugins are being installed into $(prefix)/lib/sasl2,"; \
+	  echo "* Plugins are being installed into $(libdir)/sasl2,"; \
 	  echo "* but the library will look for them in $(plugindir)."; \
 	  echo "* You need to make sure that the plugins will eventually"; \
 	  echo "* be in $(plugindir) -- the easiest way is to make a"; \
-	  echo "* symbolic link from $(plugindir) to $(prefix)/lib/sasl2,"; \
+	  echo "* symbolic link from $(plugindir) to $(libdir)/sasl2,"; \
 	  echo "* but this may not be appropriate for your site, so this"; \
 	  echo "* installation procedure won't do it for you."; \
 	  echo "*"; \
diff -uNr cyrus-sasl-2.1.20-orig/configure cyrus-sasl-2.1.20/configure
--- cyrus-sasl-2.1.20-orig/configure	2004-10-25 06:21:08.000000000 +1000
+++ cyrus-sasl-2.1.20/configure	2004-10-25 21:38:31.938032360 +1000
@@ -904,7 +904,7 @@
   --with-pgsql=PATH       use PostgreSQL from PATH
   --with-sqlite=PATH       use SQLite from PATH
   --with-plugindir=DIR    set the directory where plugins will
-                          be found [/usr/lib/sasl2]
+                          be found [LIBDIR/sasl2]
   --with-rc4              use internal rc4 routines [yes]
   --with-dmalloc=DIR      with DMALLOC support (for test applications) [no]
   --with-sfio=DIR         with SFIO support (for smtptest/libsfsasl) [no]
@@ -11437,7 +11437,7 @@
   withval="$with_plugindir"
   plugindir=$withval
 else
-  plugindir=/usr/lib/sasl2
+  plugindir=${libdir}/sasl2
 fi;
 
 cat >>confdefs.h <<_ACEOF
diff -uNr cyrus-sasl-2.1.20-orig/plugins/Makefile.in cyrus-sasl-2.1.20/plugins/Makefile.in
--- cyrus-sasl-2.1.20-orig/plugins/Makefile.in	2004-10-25 06:21:09.000000000 +1000
+++ cyrus-sasl-2.1.20/plugins/Makefile.in	2004-10-25 21:37:53.787832072 +1000
@@ -255,7 +255,7 @@
 
 common_sources = plugin_common.c plugin_common.h
 
-sasldir = $(prefix)/lib/sasl2
+sasldir = $(libdir)/sasl2
 sasl_LTLIBRARIES = @SASL_MECHS@
 EXTRA_LTLIBRARIES = libplain.la libanonymous.la libkerberos4.la libcrammd5.la \
 	libgssapiv2.la libdigestmd5.la liblogin.la libsrp.la libotp.la \
